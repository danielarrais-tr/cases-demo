<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Mock Upload – mesma estrutura/IDs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* Estilos só pra ficar parecido e expor cenários de teste */
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#f6f7fb; margin:0; padding:24px; }
    .panel { max-width: 980px; margin: 0 auto; background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:24px; box-shadow: 0 6px 20px rgba(0,0,0,.06); }
    .controls { display:flex; flex-wrap:wrap; gap:8px; margin-bottom:16px; }
    .controls button { padding:8px 12px; border-radius:8px; border:1px solid #d1d5db; background:#fff; cursor:pointer; }
    .controls button:active { transform: translateY(1px); }
    .log { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#111827; color:#d1d5db; border-radius:8px; padding:12px; height:160px; overflow:auto; white-space:pre-wrap; }

    /* ---- Área do seu componente (mantendo classes/IDs) ---- */
    a-form { display:block; }

    .fileUpload--Pdqo5 {
      display:flex;
      background:#f2f2f2;
      border:2px dashed #c7c7c7;
      border-radius:12px;
      align-items:center;
      justify-content:center;
      height:160px;
      position:relative;
    }
    .fileUpload_inner--JDKn9 {
      display:flex;
      width:100%;
      height:100%;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      user-select:none;
    }
    .fileUpload_inner--JDKn9:focus { outline: 2px solid #6366f1; outline-offset: 3px; }

    /* Checkbox estilo leve para visualizar */
    .ap-checkbox-container { display:flex; align-items:center; gap:10px; margin-top:12px; }
    .ap-checkbox { position:relative; width:24px; height:24px; display:block; }
    .ap-checkbox-input { position:absolute; inset:0; opacity:0; }
    .Appkit4-icon.icon-checkbox-deselected-fill::before {
      content:"☐";
      display:inline-block;
      line-height:24px;
      width:24px; height:24px;
      text-align:center;
      font-size:18px;
    }
    .icon-checkbox-backdrop-outline { display:none; }
    .ap-checkbox-input:checked + .Appkit4-icon.icon-checkbox-deselected-fill::before { content:"☑"; }

    .ap-checkbox-disabled { opacity:.5; cursor:not-allowed; }

    /* Cenários simulados para o input real */
    .hidden-display { display:none !important; }
    .hidden-visibility { visibility:hidden !important; }
    .hidden-opacity { opacity:0 !important; pointer-events:none; }
    .offscreen { position:absolute !important; left:-10000px !important; top:auto !important; width:1px !important; height:1px !important; overflow:hidden !important; }

    /* Drop feedback */
    .fileUpload--drag { border-color:#6b7280; background:#eef2ff; }
  </style>
</head>
<body>
  <div class="panel">
    <h1>Mock de Upload (mesmas IDs/classes)</h1>
    <p>Use os botões abaixo para alternar como o <code>&lt;input type="file"&gt;</code> “real” se apresenta. O log mostra cliques e mudanças de estado.</p>

    <div class="controls">
      <button id="btn-display-none">Aplicar display:none</button>
      <button id="btn-visibility-hidden">Aplicar visibility:hidden</button>
      <button id="btn-opacity-0">Aplicar opacity:0</button>
      <button id="btn-offscreen">Mover offscreen</button>
      <button id="btn-reset">Resetar (visível)</button>
      <button id="btn-click-real">Tentar clicar no input real via JS</button>
    </div>

    <!-- LOG -->
    <div class="log" id="log"></div>

    <!-- ===== SUA ESTRUTURA ===== -->
    <a-form
      data-x-testrigor-xpath="/html[1]/body[1]/div[2]/div[1]/div[1]/div[2]/form[1]"
      data-x-testrigor-xpath-short="//div[@id='My_Data_App_DocumentLibrary_AddData_ModalUploadData_Modal']/div[1]/div[2]/form[1]"
      data-x-testrigor-cursor="auto" data-x-testrigor-font-size="16"
      data-x-testrigor-shadow-root="false" data-x-testrigor-shadow-host=""
      data-x-testrigor-css-x="630" data-x-testrigor-css-y="375"
      data-x-testrigor-css-width="660" data-x-testrigor-css-height="228"
      data-x-testrigor-css-text-transform="none" background-color="rgba(0, 0, 0, 0)"
      data-x-testrigor-css-display="block" data-x-testrigor-position="static"
      data-x-testrigor-z-index="auto" data-x-testrigor-overflow-y="visible"
      data-x-testrigor-x="630" data-x-testrigor-y="375" data-x-testrigor-width="660"
      data-x-testrigor-height="228" data-x-testrigor-possibly-visible="true"
      data-x-testrigor-visible="true" data-x-testrigor-accessible="true"
      data-x-testrigor-visible-fixed="true">

      <div role="presentation" tabindex="0" class="fileUpload--Pdqo5"
           data-x-testrigor-xpath="/html[1]/body[1]/div[2]/div[1]/div[1]/div[2]/form[1]/div[1]"
           data-x-testrigor-xpath-short="//div[@id='My_Data_App_DocumentLibrary_AddData_ModalUploadData_Modal']/div[1]/div[2]/form[1]/div[1]"
           background-color="rgb(242, 242, 242)" data-x-testrigor-css-display="flex">

        <!-- INPUT REAL (mesmo id) -->
        <input id="My_Data_App_DocumentLibrary_AddData_ModalUploadData_File_Upload_Field"
               multiple type="file" tabindex="-1" style="display: none;"
               data-x-testrigor-xpath="/html[1]/body[1]/div[2]/div[1]/div[1]/div[2]/form[1]/div[1]/input[1]"
               data-x-testrigor-xpath-short="//input[@id='My_Data_App_DocumentLibrary_AddData_ModalUploadData_File_Upload_Field']">

        <!-- BOTÃO FAKE QUE CHAMA O INPUT REAL -->
        <div role="button" tabindex="0" class="fileUpload_inner--JDKn9"
             data-x-testrigor-xpath="/html[1]/body[1]/div[2]/div[1]/div[1]/div[2]/form[1]/div[1]/div[1]">
          <a-p data-x-testrigor-xpath="/html[1]/body[1]/div[2]/div[1]/div[1]/div[2]/form[1]/div[1]/div[1]/p[1]">
            Drag and drop,
            <span>or choose your file</span>
          </a-p>
        </div>
      </div>

      <!-- Checkboxes -->
      <div
        data-x-testrigor-xpath="/html[1]/body[1]/div[2]/div[1]/div[1]/div[2]/form[1]/div[2]">
        <div class="ap-checkbox-container" id="My_Data_App_DocumentLibrary_AddData_ModalUploadData_Unzipcheckbox" data-theme="black">
          <div class="ap-checkbox">
            <div class="a-hidden-accessibility">
              <input type="checkbox" role="checkbox" aria-live="assertive"
                     aria-label="Unzip any compressed files" id="checkbox-7"
                     tabindex="0" class="ap-checkbox-input" value="">
            </div>
            <span class="Appkit4-icon icon-checkbox-deselected-fill" aria-hidden="true"></span>
            <span class="icon-checkbox-backdrop-outline" aria-hidden="true"></span>
          </div>
          <label class="ap-checkbox-label" for="checkbox-7" aria-hidden="true">Unzip any compressed files</label>
        </div>

        <div class="ap-checkbox-container MDDCheckbox" id="My_Data_App_DocumentLibrary_AddData_ModalUploadData_Mddcheckbox" data-theme="black">
          <div class="ap-checkbox ap-checkbox-disabled">
            <div class="a-hidden-accessibility">
              <input type="checkbox" role="checkbox" aria-live="assertive"
                     aria-label="Allow Workspace asset metadata to be discovered outside this Workspace"
                     aria-disabled="true" aria-checked="false" id="checkbox-8"
                     tabindex="0" disabled class="ap-checkbox-input" value="">
            </div>
            <span class="Appkit4-icon icon-checkbox-deselected-fill" aria-hidden="true"></span>
            <span class="icon-checkbox-backdrop-outline" aria-hidden="true"></span>
          </div>
          <label class="ap-checkbox-label" for="checkbox-8" aria-hidden="true">
            Allow Workspace asset metadata to be discovered outside this Workspace
          </label>
        </div>
      </div>
    </a-form>
  </div>

  <script>
    const $ = (sel) => document.querySelector(sel);
    const log = (msg) => {
      const el = $('#log');
      const stamp = new Date().toISOString().replace('T',' ').replace('Z','');
      el.textContent += `[${stamp}] ${msg}\n`;
      el.scrollTop = el.scrollHeight;
    };

    const fileInput = document.getElementById('My_Data_App_DocumentLibrary_AddData_ModalUploadData_File_Upload_Field');
    const fakeButton = document.querySelector('.fileUpload_inner--JDKn9');
    const dropZone = document.querySelector('.fileUpload--Pdqo5');

    // Simular comportamento de UI real: clicar no "fake" dispara o input real
    const openPicker = () => {
      try {
        log('Clique no FAKE -> tentando chamar input.click()');
        fileInput.click();
      } catch (e) {
        log('ERRO ao chamar input.click(): ' + e);
      }
    };

    // Drag & drop mínimo
    ['dragenter', 'dragover'].forEach(evt => {
      dropZone.addEventListener(evt, (e) => {
        e.preventDefault();
        e.stopPropagation();
        dropZone.classList.add('fileUpload--drag');
      });
    });
    ;['dragleave', 'drop'].forEach(evt => {
      dropZone.addEventListener(evt, (e) => {
        e.preventDefault();
        e.stopPropagation();
        dropZone.classList.remove('fileUpload--drag');
      });
    });
    dropZone.addEventListener('drop', (e) => {
      const files = e.dataTransfer.files;
      log(`Arquivos soltos: ${files.length}`);
    });

    fakeButton.addEventListener('click', (e) => {
      e.preventDefault();
      openPicker();
    });
    fakeButton.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        openPicker();
      }
    });

    fileInput.addEventListener('change', () => {
      const names = [...fileInput.files].map(f => f.name).join(', ');
      log(`Input REAL disparou "change": ${fileInput.files.length} arquivo(s) -> ${names || '(sem nomes)'}`);
    });

    // ---- Controles de cenário ----
    const removeAllVisibilityClasses = () => {
      fileInput.classList.remove('hidden-display','hidden-visibility','hidden-opacity','offscreen');
      fileInput.style.display = ''; // também limpa inline do exemplo
    };

    $('#btn-display-none').addEventListener('click', () => {
      removeAllVisibilityClasses();
      fileInput.classList.add('hidden-display');
      log('Cenário: display:none aplicado ao input real');
    });

    $('#btn-visibility-hidden').addEventListener('click', () => {
      removeAllVisibilityClasses();
      fileInput.classList.add('hidden-visibility');
      log('Cenário: visibility:hidden aplicado ao input real');
    });

    $('#btn-opacity-0').addEventListener('click', () => {
      removeAllVisibilityClasses();
      fileInput.classList.add('hidden-opacity');
      log('Cenário: opacity:0 + pointer-events:none aplicado ao input real');
    });

    $('#btn-offscreen').addEventListener('click', () => {
      removeAllVisibilityClasses();
      fileInput.classList.add('offscreen');
      log('Cenário: input real movido para fora da viewport (offscreen)');
    });

    $('#btn-reset').addEventListener('click', () => {
      removeAllVisibilityClasses();
      log('Cenário: reset -> input real visível (exceto style inline original "display:none" será removido)');
    });

    // Forçar clique direto no input real (simula automação que ignora o fake)
    $('#btn-click-real').addEventListener('click', () => {
      try {
        log('Tentando clicar DIRETAMENTE no input real via JS');
        fileInput.click();
      } catch (e) {
        log('ERRO ao clicar no input real: ' + e);
      }
    });

    // Estado inicial fiel ao snippet: input oculto via inline style
    log('Init: input real começa com style="display:none" (igual ao snippet). Use os botões para alternar estados.');
  </script>
</body>
</html>
